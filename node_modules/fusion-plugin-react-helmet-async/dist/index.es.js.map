{"version":3,"file":"index.es.js","sources":["../src/server.js","../src/browser.js","../src/index.js"],"sourcesContent":["/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport React from 'react';\nimport {createPlugin, dangerouslySetHTML} from 'fusion-core';\nimport {HelmetProvider} from 'react-helmet-async';\n\nimport type {FusionPlugin} from 'fusion-core';\n\nconst keys = ['meta', 'link', 'style', 'base', 'noscript', 'script'];\n\nconst plugin =\n  __NODE__ &&\n  createPlugin({\n    middleware: () => {\n      return async (ctx, next) => {\n        if (!ctx.element) {\n          return next();\n        }\n        const helmetContext = {};\n        ctx.element = (\n          <HelmetProvider context={helmetContext}>{ctx.element}</HelmetProvider>\n        );\n        await next();\n        const {helmet} = helmetContext;\n        if (helmet) {\n          ctx.template.title = helmet.title\n            .toString()\n            .replace('</title>', '')\n            .replace(/^<title.*>/, '');\n          keys.forEach(key => {\n            ctx.template.head.push(dangerouslySetHTML(helmet[key].toString()));\n          });\n        }\n      };\n    },\n  });\n\nexport default ((plugin: any): FusionPlugin<void, void>);\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport React from 'react';\nimport {createPlugin} from 'fusion-core';\nimport {HelmetProvider} from 'react-helmet-async';\n\nimport type {FusionPlugin} from 'fusion-core';\n\nconst plugin =\n  __BROWSER__ &&\n  createPlugin({\n    middleware: () => {\n      return (ctx, next) => {\n        ctx.element = (\n          <HelmetProvider context={{}}>{ctx.element}</HelmetProvider>\n        );\n        return next();\n      };\n    },\n  });\n\nexport default ((plugin: any): FusionPlugin<void, void>);\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport Helmet from 'react-helmet-async';\nimport serverPlugin from './server';\nimport clientPlugin from './browser';\n\ndeclare var __NODE__: Boolean;\nexport default (__NODE__ ? serverPlugin : clientPlugin);\nexport {Helmet};\n"],"names":["keys","plugin","createPlugin","middleware","ctx","next","element","helmetContext","helmet","template","title","toString","replace","forEach","key","head","push","dangerouslySetHTML","serverPlugin"],"mappings":";;;;;AAAA;;;;;;;AAQA,AAMA,MAAMA,IAAI,GAAG,CAAC,MAAD,EAAS,MAAT,EAAiB,OAAjB,EAA0B,MAA1B,EAAkC,UAAlC,EAA8C,QAA9C,CAAb;AAEA,MAAMC,MAAM,GACV,QACAC,YAAY,CAAC;EACXC,UAAU,EAAE,MAAM;WACT,OAAOC,GAAP,EAAYC,IAAZ,KAAqB;UACtB,CAACD,GAAG,CAACE,OAAT,EAAkB;eACTD,IAAI,EAAX;;;YAEIE,aAAa,GAAG,EAAtB;MACAH,GAAG,CAACE,OAAJ,GACE,oBAAC,cAAD;QAAgB,OAAO,EAAEC;SAAgBH,GAAG,CAACE,OAA7C,CADF;YAGMD,IAAI,EAAV;YACM;QAACG;UAAUD,aAAjB;;UACIC,MAAJ,EAAY;QACVJ,GAAG,CAACK,QAAJ,CAAaC,KAAb,GAAqBF,MAAM,CAACE,KAAP,CAClBC,QADkB,GAElBC,OAFkB,CAEV,UAFU,EAEE,EAFF,EAGlBA,OAHkB,CAGV,YAHU,EAGI,EAHJ,CAArB;QAIAZ,IAAI,CAACa,OAAL,CAAaC,GAAG,IAAI;UAClBV,GAAG,CAACK,QAAJ,CAAaM,IAAb,CAAkBC,IAAlB,CAAuBC,kBAAkB,CAACT,MAAM,CAACM,GAAD,CAAN,CAAYH,QAAZ,EAAD,CAAzC;SADF;;KAfJ;;CAFQ,CAFd;;AChBA;;;;;;;;ACAA;;;;;;;AAQA,AAKA,YAA2BO,MAA3B;;;;"}